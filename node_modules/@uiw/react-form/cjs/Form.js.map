{
  "version": 3,
  "sources": [
    "../src/Form.tsx"
  ],
  "names": [
    "newFormState",
    "fields",
    "cb",
    "state",
    "initial",
    "current",
    "submitting",
    "errors",
    "name",
    "props",
    "initialValue",
    "currentValue",
    "newInitialValue",
    "value",
    "undefined",
    "isPromise",
    "promise",
    "then",
    "Form",
    "ref",
    "prefixCls",
    "className",
    "children",
    "resetOnSubmit",
    "onSubmitError",
    "onChange",
    "onSubmit",
    "afterSubmit",
    "others",
    "initData",
    "data",
    "setData",
    "formUnits",
    "error",
    "checked",
    "childField",
    "controlField",
    "help",
    "labelFor",
    "key",
    "hasError",
    "handleChange",
    "validator",
    "element",
    "env",
    "list",
    "target",
    "test",
    "type",
    "nextState",
    "persist",
    "handleSubmit",
    "e",
    "preventDefault",
    "onError",
    "evn",
    "onSuccess",
    "response",
    "reset",
    "handleReset",
    "afterSubmitPromise",
    "canSubmit",
    "passesValidators",
    "Object",
    "prototype",
    "hasOwnProperty",
    "call",
    "label",
    "labelClassName",
    "labelStyle",
    "inline",
    "other",
    "React",
    "Children",
    "count",
    "hasCurrentValue",
    "id",
    "cloneElement",
    "filter",
    "Boolean",
    "join",
    "trim",
    "disabled",
    "resetForm",
    "forwardRef"
  ],
  "mappings": "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",
  "sourcesContent": [
    "import React, { useState } from 'react';\nimport { IProps } from '@uiw/utils';\nimport FormItem, { FormItemProps } from './FormItem';\nimport './style/form.less';\n\nexport interface FormProps<T>\n  extends IProps,\n    Omit<React.FormHTMLAttributes<HTMLFormElement>, 'onChange' | 'onSubmit'> {\n  prefixCls?: string;\n  fields?: Record<string, FormFieldsProps<T>>;\n  onSubmit?: (state: FormSubmitProps) => any;\n  afterSubmit?: (result: FormAfterSubmitProps) => any;\n  onChange?: (state: FormState) => void;\n  onSubmitError?: (evn: any) => any;\n  resetOnSubmit?: boolean;\n  children?: (\n    handle: FormChildrenProps,\n  ) => JSX.Element | JSX.Element | undefined;\n}\n\nexport interface FormState {\n  submitting: boolean;\n  initial: Record<string, any>;\n  current: FormState['initial'];\n  errors: Record<string, any>;\n}\n\nexport interface FormFieldsProps<T> extends FormItemProps<T> {\n  name?: string;\n  children?: React.ReactNode;\n  help?: React.ReactNode;\n  labelFor?: string;\n  inline?: boolean;\n  checked?: boolean;\n  initialValue?: string | number | T;\n  validator?: (currentValue: any) => any;\n}\n\nexport interface FormSubmitProps {\n  initial: FormState['initial'];\n  current: FormState['current'];\n}\n\nexport interface FormAfterSubmitProps {\n  state: FormState;\n  response: any;\n  reset: () => void;\n}\n\nexport interface FormChildrenProps {\n  fields: Record<string, React.ReactElement>;\n  resetForm: () => void;\n  canSubmit: () => boolean;\n  state: FormState;\n}\n\nexport type FormElementProps = {\n  id?: string;\n  name?: string;\n  value?: string;\n  checked?: boolean;\n  onChange?: (\n    env: React.BaseSyntheticEvent<HTMLInputElement>,\n    list?: string[],\n  ) => void;\n};\n\nfunction newFormState<T>(\n  fields: FormProps<T>['fields'],\n  cb: (\n    porps: FormFieldsProps<T>,\n  ) => {\n    initialValue: FormFieldsProps<T>['initialValue'];\n    currentValue: FormFieldsProps<T>['initialValue'];\n  },\n): FormState {\n  const state: FormState = {\n    initial: {},\n    current: {},\n    submitting: false,\n    errors: {},\n  };\n  for (const name in fields) {\n    const props = fields[name];\n    if (!props) continue;\n    const { initialValue, currentValue } = cb({ ...props, name });\n    state.initial[name] = initialValue;\n    state.current[name] = currentValue;\n  }\n  return state;\n}\n\nfunction newInitialValue<T>(value: FormFieldsProps<T>['initialValue']) {\n  return value === null || value === undefined ? '' : value;\n}\n\nconst isPromise = (promise: Promise<any>) =>\n  promise && typeof promise.then === 'function';\n\nfunction Form<T>(\n  {\n    prefixCls = 'w-form',\n    className,\n    fields,\n    children,\n    resetOnSubmit,\n    onSubmitError,\n    onChange,\n    onSubmit,\n    afterSubmit,\n    ...others\n  }: FormProps<T>,\n  ref:\n    | ((instance: HTMLInputElement) => void)\n    | React.RefObject<HTMLInputElement | null>\n    | null,\n) {\n  const initData = newFormState(fields, ({ initialValue }) => {\n    initialValue = newInitialValue(initialValue);\n    return { initialValue, currentValue: initialValue };\n  });\n\n  const [data, setData] = useState<FormState>(initData);\n\n  const formUnits: FormChildrenProps['fields'] = {};\n  for (const name in fields) {\n    const props = fields[name];\n    if (!props) continue;\n    const error = data.errors[name];\n    if (typeof props.initialValue === 'boolean') {\n      props.checked = props.initialValue;\n    }\n    const childField: FormFieldsProps<T> = controlField({\n      ...props,\n      name,\n    });\n    const help = error || props.help;\n    const labelFor = props.labelFor;\n    formUnits[name] = (\n      <FormItem\n        {...{\n          ...props,\n          key: name,\n          children: childField,\n          help,\n          labelFor,\n          state: data,\n          name,\n          hasError: !!error,\n        }}\n      />\n    );\n  }\n\n  function handleChange(\n    name: string,\n    validator: FormFieldsProps<T>['validator'],\n    element?: React.ReactElement,\n    cb?: (env: React.BaseSyntheticEvent<HTMLInputElement>) => void,\n  ) {\n    return (\n      env: React.BaseSyntheticEvent<HTMLInputElement>,\n      list?: string[],\n    ) => {\n      let value =\n        env && env.target && 'value' in env.target ? env.target.value : env;\n      // 控件 Checkbox.Group 多选值的处理\n      value = list || value;\n      // 控件 Checkbox 值的处理\n      if (\n        !list &&\n        element &&\n        env &&\n        env.target &&\n        /(radio)/.test(env.target.type)\n      ) {\n        // 控件 Switch/Radio/Checkbox 值的处理\n        value = env.target.value ? env.target.value : env.target.checked;\n      }\n      if (\n        !list &&\n        element &&\n        env &&\n        env.target &&\n        /(checkbox)/.test(env.target.type)\n      ) {\n        // 控件 Switch/Radio/Checkbox 值的处理\n        value = env.target.checked;\n      }\n      const nextState = {\n        current: { ...data.current, [name]: value },\n      } as FormState;\n      const error = validator && validator(value);\n      if (!error) {\n        nextState.errors = { ...data.errors };\n        delete nextState.errors[name];\n      }\n      if (env && env.persist && typeof env.persist === 'function')\n        env.persist();\n      setData({ ...data, ...nextState });\n      if (cb) {\n        cb(env);\n      }\n      onChange && onChange({ ...data, ...nextState });\n    };\n  }\n\n  function handleSubmit(e: React.FormEvent) {\n    e && e.preventDefault();\n    const { initial, current } = data;\n    setData({ ...data, submitting: true });\n    const nextState = { submitting: false } as FormState;\n    const onError = (evn: React.FormEvent) =>\n      setData({\n        ...data,\n        ...nextState,\n        errors: (onSubmitError && onSubmitError(evn)) || {},\n      });\n    const onSuccess = (response: any) => {\n      if (resetOnSubmit) {\n        nextState.current = initial;\n      }\n      setData({ ...data, ...nextState, errors: {} });\n      return () => afterSubmit!({ state: data, response, reset: handleReset });\n    };\n    try {\n      const afterSubmitPromise = onSubmit!({ initial, current });\n      if (isPromise(afterSubmitPromise)) {\n        return afterSubmitPromise.then(onSuccess).catch(onError);\n      } else {\n        return onSuccess(afterSubmitPromise);\n      }\n    } catch (evn) {\n      onError(evn);\n    }\n  }\n\n  function canSubmit() {\n    const { submitting, current = {} } = data;\n    let passesValidators = true;\n    for (const name in fields) {\n      if (Object.prototype.hasOwnProperty.call(fields, name)) {\n        const props: FormFieldsProps<T> = fields[name];\n        if (!props) continue;\n        if (props.validator && props.validator(current[name])) {\n          passesValidators = false;\n          break;\n        }\n      }\n    }\n    return !submitting && passesValidators;\n  }\n\n  function handleReset() {\n    const { initial } = data;\n    setData({ ...data, current: initial, errors: {} });\n  }\n\n  function controlField({\n    children,\n    validator,\n    name,\n    help,\n    label,\n    labelFor,\n    labelClassName,\n    labelStyle,\n    inline,\n    initialValue,\n    ...other\n  }: FormFieldsProps<T>) {\n    const element =\n      typeof children !== 'function'\n        ? children\n        : children({\n            onChange: handleChange(name!, validator),\n            onSubmit: handleSubmit,\n            canSubmit: canSubmit,\n          });\n    if (!element || React.Children.count(element) !== 1 || !name)\n      return element;\n    const props = {\n      name: element.props.name || name,\n      ...other,\n    } as FormElementProps;\n    const hasCurrentValue = Object.prototype.hasOwnProperty.call(\n      data.current,\n      name,\n    );\n    props.id = element.props.id;\n    props.value = hasCurrentValue\n      ? data.current && data.current[name]\n      : props.value;\n    // : element.props.value;\n\n    const type = element.props.type;\n    if (type === 'checkbox' || type === 'switch') {\n      props.checked = !!props.checked;\n      delete props.value;\n    }\n    props.onChange = handleChange(\n      name,\n      validator,\n      element,\n      element.props.onChange,\n    ) as FormElementProps['onChange'];\n    return React.cloneElement(element, props as FormElementProps);\n  }\n  return (\n    <form\n      {...{\n        ...others,\n        className: [prefixCls, className].filter(Boolean).join(' ').trim(),\n        onSubmit: handleSubmit,\n      }}\n    >\n      <fieldset {...{ disabled: data.submitting }}>\n        {typeof children === 'function'\n          ? children({\n              fields: formUnits,\n              state: data,\n              resetForm: handleReset,\n              canSubmit: canSubmit,\n            })\n          : children}\n      </fieldset>\n    </form>\n  );\n}\n\nexport default React.forwardRef<HTMLInputElement, FormProps<{}>>(Form);\n"
  ]
}